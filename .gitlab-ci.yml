 macos-build:
  except:
    - schedules
  stage: build
  tags:
    - shared-macos-amd64
#  rules:
#    - *do_not_run_for_schedules
    # Mac runner is restricted to "siril" namespace; only generate pipelines for this
#    - if: '$CI_PROJECT_NAMESPACE == "siril"'
  variables:
    SDKROOT: /opt/sdks/MacOSX10.13.sdk
  before_script:
    - build/macOS/uninstall_toolset.sh
    - build/macOS/install_toolset.sh
  script:
    - build/macOS/build_siril.sh
#  after_script:
#    - build/macOS/uninstall_toolset.sh
  artifacts:
    expire_in: 1 week
    paths:
      - Siril.dmg